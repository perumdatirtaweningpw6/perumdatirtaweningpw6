<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>perumdatirtawening.com</title>

  <!-- libs -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet"/>

  <style>
    :root {
      --brand:#4db8ff;
      --ink:#cfeaff;
      --panel: rgba(16, 40, 78, 0.85);
      --panel-soft: rgba(16, 40, 78, 0.65);
    }
    body {
      background:#0b1f3b;
      color:#fff;
      font-family:'Segoe UI',sans-serif;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .card {
      background: var(--panel);
      border:none;
      border-radius:18px;
      color:#fff;
      box-shadow:0 0 15px rgba(0,0,0,.3);
    }
    .form-control {
      background: rgba(255,255,255,0.08);
      color:#fff;
      border:1px solid rgba(255,255,255,0.15);
    }
    .form-control::placeholder{ color:#cfeaff; opacity:.6; }
    .btn-brand {
      background: var(--brand);
      color:#07263f;
      border:none;
    }
    .btn-brand:hover{ background:#64c2ff; }
    a { color: var(--ink); text-decoration:none; }
    a:hover { text-decoration:underline; }
  </style>
</head>
<body>
  <div class="container px-3">
    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5" data-aos="zoom-in">
        <div class="card p-4">
          <div class="text-center mb-3">
            <img src="https://perumdatirtawening.co.id/asset/image/logo-horizon-kecils.gif" alt="Logo" height="60"/>
          <p class="text-secondary mb-3">Masukkan email dinas dan PIN untuk masuk.</p>

          <div class="mb-3 text-start">
            <label for="email" class="form-label">Username</label>
            <input type="email" id="email" class="form-control" placeholder="perumdatirtawening@gmail.com" required>
          </div>
          <div class="mb-3 text-start">
            <label for="pin" class="form-label">PIN</label>
            <input type="password" id="pin" class="form-control" maxlength="6" placeholder="Masukkan PIN" required>
          </div>

          <button id="btnLogin" class="btn btn-brand w-100 mt-2">
            <i class="fas fa-right-to-bracket me-2"></i>Masuk
          </button>
          <div id="msg" class="small text-warning mt-3 fw-semibold"></div>

          <hr class="border-secondary opacity-25 my-4"/>
          <div class="d-flex justify-content-between align-items-center">
            <a href="TeknisiUsers.html" class="small text-info">Daftar Teknisi</a>
            <a href="index.html" class="small text-info">Kembali</a>
          </div>
          <div class="text-secondary small mt-2">Lupa PIN? hubungi admin.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- libs -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>AOS.init({duration:800, once:true});</script>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbwMLCYvMZIM9uMuZlzqsnhroINTh8gcLr9fQcbQLTTP4LcqzBSO50hFJCfAFncBNnW5Bw/exec";

    document.getElementById("btnLogin").addEventListener("click", async () => {
      const email = document.getElementById("email").value.trim();
      const pin   = document.getElementById("pin").value.trim();
      const msgEl = document.getElementById("msg");

      msgEl.textContent = "";

      if (!email || !pin) {
        msgEl.textContent = "Email dan PIN wajib diisi.";
        return;
      }

      try {
        const params = new URLSearchParams({ mode: "teknisi_auth", email, pin });
        const res = await fetch(GAS_URL, { method: "POST", body: params });
        const result = await res.json();

        if (result.status === "ok") {
          localStorage.setItem("teknisi_email", result.email);
          localStorage.setItem("teknisi_nama", result.nama);
          window.location.href = "dashboard-teknisi.html";
        } else {
          msgEl.textContent = result.message || "Login gagal.";
        }
      } catch (err) {
        msgEl.textContent = "Terjadi kesalahan koneksi.";
      }
    });
  </script>
</body>
</html>
